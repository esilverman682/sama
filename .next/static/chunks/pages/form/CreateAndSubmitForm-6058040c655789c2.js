(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9163],{6666:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/form/CreateAndSubmitForm",function(){return i(2772)}])},2772:function(e,t,i){"use strict";i.r(t);var n=i(5893),r=i(7294),l=i(7066),a=i(3454);t.default=()=>{let[e,t]=(0,r.useState)(null),[i,o]=(0,r.useState)({}),[d,s]=(0,r.useState)(""),[u,m]=(0,r.useState)(null),[c,p]=(0,r.useState)(!1),[v,f]=(0,r.useState)(null),h=async()=>{var e,i,n,r;p(!0),f(null);try{let r=await l.Z.post(a.env.NEXT_PUBLIC_STAGING_URL,{query:"\n    mutation CreateGravityForm($title: String!, $description: String, $fields: [GFFieldInput]!) {\n      createGravityForm(input: {\n        title: $title,\n        description: $description,\n        fields: $fields\n      }) {\n        gravityForm {\n          id\n          title\n          fields {\n            id\n            label\n            type\n            required\n          }\n        }\n      }\n    }\n  ",variables:{title:d,description:"Form Description",fields:[{type:"text",label:"First Name",id:1,required:!0},{type:"email",label:"Email",id:2,required:!0}]}},{headers:{"Content-Type":"application/json"}}),o=null===(n=r.data)||void 0===n?void 0:null===(i=n.data)||void 0===i?void 0:null===(e=i.createGravityForm)||void 0===e?void 0:e.gravityForm;t(o)}catch(e){console.error("Error creating form:",(null===(r=e.response)||void 0===r?void 0:r.data)||e.message),f("Error creating the form.")}finally{p(!1)}},y=e=>{let{name:t,value:i}=e.target;o(e=>({...e,[t]:i}))},b=async t=>{var n,r,a,d;t.preventDefault(),f(null),m(null);try{let t=e.id,d=Object.keys(i).map(e=>({id:parseInt(e.split("_")[1]),value:i[e]})),s={query:"\n    mutation SubmitGravityForm($formId: Int!, $fieldValues: [GFFieldValueInput]!) {\n      submitGravityForm(input: {\n        formId: $formId,\n        fieldValues: $fieldValues\n      }) {\n        isValid\n        entry {\n          id\n        }\n      }\n    }\n  ",variables:{formId:parseInt(t),fieldValues:d}},u=await l.Z.post("https://kapstaging.com/graphql",s,{headers:{"Content-Type":"application/json"}});(null===(a=u.data)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:null===(n=r.submitGravityForm)||void 0===n?void 0:n.isValid)?(m("Form submitted successfully!"),o({})):f("Form validation failed. Please check the fields.")}catch(e){console.error("Error submitting form:",(null===(d=e.response)||void 0===d?void 0:d.data)||e.message),f("Error submitting the form.")}};return(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{children:"Create and Submit Form (GraphQL)"}),!e&&(0,n.jsxs)("div",{children:[(0,n.jsx)("input",{type:"text",placeholder:"Enter Form Name",value:d,onChange:e=>s(e.target.value),required:!0}),(0,n.jsx)("button",{onClick:h,disabled:c||!d,children:c?"Creating Form...":"Create Form"})]}),e&&(0,n.jsxs)("form",{onSubmit:b,children:[e.fields.map(e=>(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:e.label}),(0,n.jsx)("input",{type:"email"===e.type?"email":"text",name:"input_".concat(e.id),value:i["input_".concat(e.id)]||"",onChange:y,required:e.required})]},e.id)),v&&(0,n.jsx)("div",{style:{color:"red"},children:v}),u&&(0,n.jsx)("div",{style:{color:"green"},children:u}),(0,n.jsx)("button",{type:"submit",children:"Submit Form"})]})]})}}},function(e){e.O(0,[7066,2888,9774,179],function(){return e(e.s=6666)}),_N_E=e.O()}]);